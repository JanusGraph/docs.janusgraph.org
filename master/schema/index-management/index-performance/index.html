
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-6.2.3">
    
    
      
        <title>Indexing for Better Performance - JanusGraph</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
    
    
    
      <link rel="stylesheet" href="../../../theme/structor-menu.css">
    
      <link rel="stylesheet" href="../../../theme/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="teal">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#indexing-for-better-performance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="JanusGraph" class="md-header-nav__button md-logo" aria-label="JanusGraph">
      
  <img src="../../../janusgraph-logomark.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            JanusGraph
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Indexing for Better Performance
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/janusgraph/janusgraph/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    JanusGraph
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="JanusGraph" class="md-nav__button md-logo" aria-label="JanusGraph">
      
  <img src="../../../janusgraph-logomark.svg" alt="logo">

    </a>
    JanusGraph
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/janusgraph/janusgraph/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    JanusGraph
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../getting-started/installation/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../getting-started/basic-usage/" class="md-nav__link">
      Basic Usage
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../getting-started/gremlin/" class="md-nav__link">
      Gremlin Query Language
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../getting-started/architecture/" class="md-nav__link">
      Architectural Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      JanusGraph Basics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="JanusGraph Basics" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        JanusGraph Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/transactions/" class="md-nav__link">
      Transactions
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/search-predicates/" class="md-nav__link">
      Search Predicates and Mixed Index Data Types
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
    
    <label class="md-nav__link" for="nav-3-3">
      Connecting to JanusGraph
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Connecting to JanusGraph" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon"></span>
        Connecting to JanusGraph
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/connecting/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/connecting/java/" class="md-nav__link">
      Using Java
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/connecting/python/" class="md-nav__link">
      Using Python
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../basics/connecting/dotnet/" class="md-nav__link">
      Using .NET
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    
    <label class="md-nav__link" for="nav-4">
      Configuration
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Configuration" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../configs/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../configs/configuration-reference/" class="md-nav__link">
      Configuration Reference
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../configs/example-config/" class="md-nav__link">
      Config Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Schema Management
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Schema Management" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Schema Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../" class="md-nav__link">
      Schema and Data Modeling
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../advschema/" class="md-nav__link">
      Advanced Schema
    </a>
  </li>

        
          
          
          


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3" checked>
    
    <label class="md-nav__link" for="nav-5-3">
      Index Management
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Index Management" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        <span class="md-nav__icon md-icon"></span>
        Index Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Indexing for Better Performance
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Indexing for Better Performance
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graph-index" class="md-nav__link">
    Graph Index
  </a>
  
    <nav class="md-nav" aria-label="Graph Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composite-index" class="md-nav__link">
    Composite Index
  </a>
  
    <nav class="md-nav" aria-label="Composite Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-uniqueness" class="md-nav__link">
    Index Uniqueness
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-index" class="md-nav__link">
    Mixed Index
  </a>
  
    <nav class="md-nav" aria-label="Mixed Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-property-keys" class="md-nav__link">
    Adding Property Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-parameters" class="md-nav__link">
    Mapping Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordering" class="md-nav__link">
    Ordering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#label-constraint" class="md-nav__link">
    Label Constraint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composite-versus-mixed-indexes" class="md-nav__link">
    Composite versus Mixed Indexes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vertex-centric-indexes" class="md-nav__link">
    Vertex-centric Indexes
  </a>
  
    <nav class="md-nav" aria-label="Vertex-centric Indexes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edge-indexes" class="md-nav__link">
    Edge Indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-indexes" class="md-nav__link">
    Property Indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-vertex-centric-indexes-on-adjacent-vertex-ids" class="md-nav__link">
    Using vertex-centric indexes on adjacent vertex ids
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordered-traversals" class="md-nav__link">
    Ordered Traversals
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../index-lifecycle/" class="md-nav__link">
      Index Lifecycle
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../index-reindexing/" class="md-nav__link">
      Reindexing
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../index-removal/" class="md-nav__link">
      Removal
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
    
    <label class="md-nav__link" for="nav-6">
      Operations
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Operations" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Operations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/server/" class="md-nav__link">
      JanusGraph Server
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/deployment/" class="md-nav__link">
      Deployment Scenarios
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/container/" class="md-nav__link">
      JanusGraph Container
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/configured-graph-factory/" class="md-nav__link">
      ConfiguredGraphFactory
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/dynamic-graphs/" class="md-nav__link">
      Dynamic Graphs
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/batch-processing/" class="md-nav__link">
      Batch Processing
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/bulk-loading/" class="md-nav__link">
      Bulk Loading
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/cache/" class="md-nav__link">
      JanusGraph Cache
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/monitoring/" class="md-nav__link">
      Monitoring
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/migrating-titan/" class="md-nav__link">
      Migrating from Titan
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/migrating-thrift/" class="md-nav__link">
      Migrating from Thrift
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/recovery/" class="md-nav__link">
      Failure & Recovery
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../operations/management/" class="md-nav__link">
      Management System
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    
    <label class="md-nav__link" for="nav-7">
      Storage Backends
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Storage Backends" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Storage Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/cassandra/" class="md-nav__link">
      Apache Cassandra
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/hbase/" class="md-nav__link">
      Apache HBase
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/bigtable/" class="md-nav__link">
      Google Cloud Bigtable
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/scylladb/" class="md-nav__link">
      ScyllaDB
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/bdb/" class="md-nav__link">
      Oracle Berkeley DB Java Edition
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../storage-backend/inmemorybackend/" class="md-nav__link">
      InMemory Storage Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" >
    
    <label class="md-nav__link" for="nav-8">
      Mixed Index Backends
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Mixed Index Backends" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Mixed Index Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/text-search/" class="md-nav__link">
      Index Parameters and Full-Text Search
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/field-mapping/" class="md-nav__link">
      Field Mapping
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/direct-index-query/" class="md-nav__link">
      Direct Index Query
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/elasticsearch/" class="md-nav__link">
      Elasticsearch
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/solr/" class="md-nav__link">
      Apache Solr
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../index-backend/lucene/" class="md-nav__link">
      Apache Lucene
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" >
    
    <label class="md-nav__link" for="nav-9">
      Advanced Topics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Advanced Topics" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Advanced Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/eventual-consistency/" class="md-nav__link">
      Eventually-Consistent Storage Backends
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/custom-vertex-id/" class="md-nav__link">
      Custom Vertex ID
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/partitioning/" class="md-nav__link">
      Graph Partitioning
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/serializer/" class="md-nav__link">
      Datatype and Attribute Serializer Configuration
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/hadoop/" class="md-nav__link">
      JanusGraph with TinkerPop’s Hadoop-Gremlin
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/transaction-log/" class="md-nav__link">
      Transaction Log
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/data-model/" class="md-nav__link">
      JanusGraph Data model
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/janusgraph-bus/" class="md-nav__link">
      JanusGraph Bus
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/executor-service/" class="md-nav__link">
      ExecutorService
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/stale-index/" class="md-nav__link">
      Permanent stale index inconsistency
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/technical-limitations/" class="md-nav__link">
      Technical Limitations
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../advanced-topics/commit-releases/" class="md-nav__link">
      Snapshot Releases
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../../common-questions/" class="md-nav__link">
      Common Questions
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../../development/" class="md-nav__link">
      Development
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../../changelog/" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graph-index" class="md-nav__link">
    Graph Index
  </a>
  
    <nav class="md-nav" aria-label="Graph Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composite-index" class="md-nav__link">
    Composite Index
  </a>
  
    <nav class="md-nav" aria-label="Composite Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-uniqueness" class="md-nav__link">
    Index Uniqueness
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-index" class="md-nav__link">
    Mixed Index
  </a>
  
    <nav class="md-nav" aria-label="Mixed Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-property-keys" class="md-nav__link">
    Adding Property Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-parameters" class="md-nav__link">
    Mapping Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordering" class="md-nav__link">
    Ordering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#label-constraint" class="md-nav__link">
    Label Constraint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composite-versus-mixed-indexes" class="md-nav__link">
    Composite versus Mixed Indexes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vertex-centric-indexes" class="md-nav__link">
    Vertex-centric Indexes
  </a>
  
    <nav class="md-nav" aria-label="Vertex-centric Indexes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edge-indexes" class="md-nav__link">
    Edge Indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-indexes" class="md-nav__link">
    Property Indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-vertex-centric-indexes-on-adjacent-vertex-ids" class="md-nav__link">
    Using vertex-centric indexes on adjacent vertex ids
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordered-traversals" class="md-nav__link">
    Ordered Traversals
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/janusgraph/janusgraph/edit/master/docs/schema/index-management/index-performance.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="indexing-for-better-performance">Indexing for Better Performance</h1>
<p>JanusGraph supports two different kinds of indexing to speed up query
processing: <strong>graph indexes</strong> and <strong>vertex-centric indexes (a.k.a. relation indexes)</strong>.
Most graph queries start the traversal from a list of vertices or edges that are
identified by their properties. Graph indexes make these global
retrieval operations efficient on large graphs. Vertex-centric indexes
speed up the actual traversal through the graph, in particular when
traversing through vertices with many incident edges.</p>
<h2 id="graph-index">Graph Index</h2>
<p>Graph indexes are global index structures over the entire graph which
allow efficient retrieval of vertices or edges by their properties for
sufficiently selective conditions. For instance, consider the following
queries
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">has</span><span class="p">(</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">hercules</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="na">E</span><span class="p">().</span><span class="na">has</span><span class="p">(</span><span class="err">&#39;</span><span class="n">reason</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">textContains</span><span class="p">(</span><span class="err">&#39;</span><span class="n">loves</span><span class="err">&#39;</span><span class="p">))</span>
</code></pre></div></p>
<p>The first query asks for all vertices with the name <code>hercules</code>. The
second asks for all edges where the property reason contains the word
<code>loves</code>. Without a graph index answering those queries would require a
full scan over all vertices or edges in the graph to find those that
match the given condition which is very inefficient and infeasible for
huge graphs.</p>
<p>JanusGraph distinguishes between two types of graph indexes:
<strong>composite</strong> and <strong>mixed</strong> indexes. Composite indexes are very fast and
efficient but limited to equality lookups for a particular,
previously-defined combination of property keys. Mixed indexes can be
used for lookups on any combination of indexed keys and support multiple
condition predicates in addition to equality depending on the backing
index store.</p>
<p>Both types of indexes are created through the JanusGraph management
system and the index builder returned by
<code>JanusGraphManagement.buildIndex(String, Class)</code> where the first
argument defines the name of the index and the second argument specifies
the type of element to be indexed (e.g. <code>Vertex.class</code>). The name of a
graph index must be unique. Graph indexes built against newly defined
property keys, i.e. property keys that are defined in the same
management transaction as the index, are immediately available. The same
applies to graph indexes that are constrained to a label that is created
in the same management transaction as the index. Graph indexes built
against property keys that are already in use without being constrained
to a newly created label require the execution of a <a href="../index-reindexing/">reindex procedure</a> 
to ensure that the index contains all previously
added elements. Until the reindex procedure has completed, the index
will not be available. It is encouraged to define graph indexes in the
same transaction as the initial schema.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the absence of an index, JanusGraph will default to a full graph
scan in order to retrieve the desired list of vertices. While this
produces the correct result set, the graph scan can be very
inefficient and lead to poor overall system performance in a
production environment. Enable the <code>force-index</code> configuration option
in production deployments of JanusGraph to prohibit graph scans.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>See <a href="../index-lifecycle/">index lifecycle documentation</a> for more information about index states.</p>
</div>
<h3 id="composite-index">Composite Index</h3>
<p>Composite indexes are stored in a separate store called <code>graphIndex</code>.
For example, if your storage backend is Cassandra, you will see a table
named <code>graphIndex</code> under your namespace.
Composite indexes retrieve vertices or edges by one or a (fixed)
composition of multiple keys. Consider the following composite index
definitions.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="p">.</span><span class="na">tx</span><span class="p">().</span><span class="na">rollback</span><span class="p">()</span> <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="p">.</span><span class="na">openManagement</span><span class="p">()</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">mgmt</span><span class="p">.</span><span class="na">getPropertyKey</span><span class="p">(</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">mgmt</span><span class="p">.</span><span class="na">getPropertyKey</span><span class="p">(</span><span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">buildIndex</span><span class="p">(</span><span class="err">&#39;</span><span class="n">byNameComposite</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">addKey</span><span class="p">(</span><span class="n">name</span><span class="p">).</span><span class="na">buildCompositeIndex</span><span class="p">()</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">buildIndex</span><span class="p">(</span><span class="err">&#39;</span><span class="n">byNameAndAgeComposite</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">addKey</span><span class="p">(</span><span class="n">name</span><span class="p">).</span><span class="na">addKey</span><span class="p">(</span><span class="n">age</span><span class="p">).</span><span class="na">buildCompositeIndex</span><span class="p">()</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">commit</span><span class="p">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="p">.</span><span class="na">awaitGraphIndexStatus</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">byNameComposite</span><span class="err">&#39;</span><span class="p">).</span><span class="na">call</span><span class="p">()</span>
<span class="n">ManagementSystem</span><span class="p">.</span><span class="na">awaitGraphIndexStatus</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">byNameAndAgeComposite</span><span class="err">&#39;</span><span class="p">).</span><span class="na">call</span><span class="p">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="p">.</span><span class="na">openManagement</span><span class="p">()</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">updateIndex</span><span class="p">(</span><span class="n">mgmt</span><span class="p">.</span><span class="na">getGraphIndex</span><span class="p">(</span><span class="s">&quot;byNameComposite&quot;</span><span class="p">),</span> <span class="n">SchemaAction</span><span class="p">.</span><span class="na">REINDEX</span><span class="p">).</span><span class="na">get</span><span class="p">()</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">updateIndex</span><span class="p">(</span><span class="n">mgmt</span><span class="p">.</span><span class="na">getGraphIndex</span><span class="p">(</span><span class="s">&quot;byNameAndAgeComposite&quot;</span><span class="p">),</span> <span class="n">SchemaAction</span><span class="p">.</span><span class="na">REINDEX</span><span class="p">).</span><span class="na">get</span><span class="p">()</span>
<span class="n">mgmt</span><span class="p">.</span><span class="na">commit</span><span class="p">()</span>
</code></pre></div></p>
<p>First, two property keys <code>name</code> and <code>age</code> are already defined. Next, a
simple composite index on just the name property key is built.
JanusGraph will use this index to answer the following query.
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">)</span>
</code></pre></div></p>
<p>The second composite graph index includes both keys. JanusGraph will use
this index to answer the following query.
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="mi">30</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">)</span>
</code></pre></div></p>
<p>Note, that all keys of a composite graph index must be found in the
query’s equality conditions for this index to be used. For example, the
following query cannot be answered with either of the indexes because it
only contains a constraint on <code>age</code> but not <code>name</code>.
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="mi">30</span><span class="o">)</span>
</code></pre></div></p>
<p>Also note, that composite graph indexes can only be used for equality
constraints like those in the queries above. The following query would
be answered with just the simple composite index defined on the <code>name</code>
key because the age constraint is not an equality constraint.
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">has</span><span class="p">(</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">hercules</span><span class="err">&#39;</span><span class="p">).</span><span class="na">has</span><span class="p">(</span><span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">inside</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</code></pre></div></p>
<p>Composite indexes do not require configuration of an external indexing
backend and are supported through the primary storage backend. Hence,
composite index modifications are persisted through the same transaction
as graph modifications which means that those changes are atomic and/or
consistent if the underlying storage backend supports atomicity and/or
consistency.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A composite index may comprise just one or multiple keys. A composite
index with just one key is sometimes referred to as a key-index.</p>
</div>
<h4 id="index-uniqueness">Index Uniqueness</h4>
<p>Composite indexes can also be used to enforce property uniqueness in the
graph. If a composite graph index is defined as <code>unique()</code> there can be
at most one vertex or edge for any given concatenation of property
values associated with the keys of that index. For instance, to enforce
that names are unique across the entire graph the following composite
graph index would be defined.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildIndex</span><span class="o">(</span><span class="s1">&#39;byNameUnique&#39;</span><span class="o">,</span> <span class="n">Vertex</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">addKey</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">unique</span><span class="o">().</span><span class="na">buildCompositeIndex</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitGraphIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;byNameUnique&#39;</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getGraphIndex</span><span class="o">(</span><span class="s2">&quot;byNameUnique&quot;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To enforce uniqueness against an eventually consistent storage
backend, the <a href="../../../advanced-topics/eventual-consistency/">consistency</a> of the index must be
explicitly set to enabling locking.</p>
</div>
<h3 id="mixed-index">Mixed Index</h3>
<p>Mixed indexes retrieve vertices or edges by any combination of
previously added property keys. Mixed indexes provide more flexibility
than composite indexes and support additional condition predicates
beyond equality. On the other hand, mixed indexes are slower for most
equality queries than composite indexes.</p>
<p>Unlike composite indexes, mixed indexes require the configuration of an
<a href="../../../index-backend/">indexing backend</a> and use that indexing backend to
execute lookup operations. JanusGraph can support multiple indexing
backends in a single installation. Each indexing backend must be
uniquely identified by name in the JanusGraph configuration which is
called the <strong>indexing backend name</strong>.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildIndex</span><span class="o">(</span><span class="s1">&#39;nameAndAge&#39;</span><span class="o">,</span> <span class="n">Vertex</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">addKey</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">addKey</span><span class="o">(</span><span class="n">age</span><span class="o">).</span><span class="na">buildMixedIndex</span><span class="o">(</span><span class="s2">&quot;search&quot;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitGraphIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;nameAndAge&#39;</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getGraphIndex</span><span class="o">(</span><span class="s2">&quot;nameAndAge&quot;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<p>The example above defines a mixed index containing the property keys
<code>name</code> and <code>age</code>. The definition refers to the indexing backend name
<code>search</code> so that JanusGraph knows which configured indexing backend it
should use for this particular index. The <code>search</code> parameter specified
in the buildMixedIndex call must match the second clause in the
JanusGraph configuration definition like this: index.<strong>search</strong>.backend
If the index was named <em>solrsearch</em> then the configuration definition
would appear like this: index.<strong>solrsearch</strong>.backend.</p>
<p>The mgmt.buildIndex example specified above uses text search as its
default behavior. An index statement that explicitly defines the index
as a text index can be written as follows:
<div class="highlight"><pre><span></span><code><span class="n">mgmt</span><span class="o">.</span><span class="na">buildIndex</span><span class="o">(</span><span class="s1">&#39;nameAndAge&#39;</span><span class="o">,</span><span class="n">Vertex</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">addKey</span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">Mapping</span><span class="o">.</span><span class="na">TEXT</span><span class="o">.</span><span class="na">asParameter</span><span class="o">()).</span><span class="na">addKey</span><span class="o">(</span><span class="n">age</span><span class="o">,</span><span class="n">Mapping</span><span class="o">.</span><span class="na">TEXT</span><span class="o">.</span><span class="na">asParameter</span><span class="o">()).</span><span class="na">buildMixedIndex</span><span class="o">(</span><span class="s2">&quot;search&quot;</span><span class="o">)</span>
</code></pre></div></p>
<p>See <a href="../../../index-backend/text-search/">Index Parameters and Full-Text Search</a> for more information on text and string
search options, and see the documentation section specific to the
indexing backend in use for more details on how each backend handles
text versus string searches.</p>
<p>While the index definition example looks similar to the composite index
above, it provides greater query support and can answer <em>any</em> of the
following queries.
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="n">textContains</span><span class="o">(</span><span class="s1">&#39;hercules&#39;</span><span class="o">)).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="n">inside</span><span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">50</span><span class="o">))</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="n">textContains</span><span class="o">(</span><span class="s1">&#39;hercules&#39;</span><span class="o">))</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="n">lt</span><span class="o">(</span><span class="mi">50</span><span class="o">))</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="n">outside</span><span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">50</span><span class="o">))</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="n">lt</span><span class="o">(</span><span class="mi">50</span><span class="o">).</span><span class="na">or</span><span class="o">(</span><span class="n">gte</span><span class="o">(</span><span class="mi">60</span><span class="o">)))</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">or</span><span class="o">(</span><span class="n">__</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="n">textContains</span><span class="o">(</span><span class="s1">&#39;hercules&#39;</span><span class="o">)),</span> <span class="n">__</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">,</span> <span class="n">inside</span><span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">50</span><span class="o">)))</span>
</code></pre></div></p>
<p>Mixed indexes support full-text search, range search, geo search and
others. Refer to <a href="../../../basics/search-predicates/">Search Predicates and Data Types</a> for a list of predicates
supported by a particular indexing backend.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike composite indexes, mixed indexes do not support uniqueness.</p>
</div>
<h4 id="adding-property-keys">Adding Property Keys</h4>
<p>Property keys can be added to an existing mixed index which allows
subsequent queries to include this key in the query condition.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">location</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">makePropertyKey</span><span class="o">(</span><span class="s1">&#39;location&#39;</span><span class="o">).</span><span class="na">dataType</span><span class="o">(</span><span class="n">Geoshape</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">make</span><span class="o">()</span>
<span class="n">nameAndAge</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getGraphIndex</span><span class="o">(</span><span class="s1">&#39;nameAndAge&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">addIndexKey</span><span class="o">(</span><span class="n">nameAndAge</span><span class="o">,</span> <span class="n">location</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Previously created property keys already have the status ENABLED, but</span>
<span class="c1">//our newly created property key &quot;location&quot; needs to REGISTER so we wait for both statuses</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitGraphIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;nameAndAge&#39;</span><span class="o">).</span><span class="na">status</span><span class="o">(</span><span class="n">SchemaStatus</span><span class="o">.</span><span class="na">REGISTERED</span><span class="o">,</span> <span class="n">SchemaStatus</span><span class="o">.</span><span class="na">ENABLED</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getGraphIndex</span><span class="o">(</span><span class="s2">&quot;nameAndAge&quot;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<p>To add a newly defined key, we first retrieve the existing index from
the management transaction by its name and then invoke the <code>addIndexKey</code>
method to add the key to this index.</p>
<p>If the added key is defined in the same management transaction, it will
be immediately available for querying. If the property key has already
been in use, adding the key requires the execution of a <a href="../index-reindexing/">reindex procedure</a> to ensure that the index contains all previously
added elements. Until the reindex procedure has completed, the key will
not be available in the mixed index.</p>
<h4 id="mapping-parameters">Mapping Parameters</h4>
<p>When adding a property key to a mixed index - either through the index
builder or the <code>addIndexKey</code> method - a list of parameters can be
optionally specified to adjust how the property value is mapped into the
indexing backend. Refer to the <a href="../../../index-backend/text-search/">mapping parameters
overview</a> for a complete list of parameter types supported
by each indexing backend.</p>
<h3 id="ordering">Ordering</h3>
<p>The order in which the results of a graph query are returned can be
defined using the <code>order().by()</code> directive. The <code>order().by()</code> method
expects two parameters:</p>
<ul>
<li>
<p>The name of the property key by which to order the results. The
    results will be ordered by the value of the vertices or edges for
    this property key.</p>
</li>
<li>
<p>The sort order: either ascending <code>asc</code> or descending <code>desc</code></p>
</li>
</ul>
<p>For example, the query
<code>g.V().has('name', textContains('hercules')).order().by('age', desc).limit(10)</code>
retrieves the ten oldest individuals with <em>hercules</em> in their name.</p>
<p>When using <code>order().by()</code> it is important to note that:</p>
<ul>
<li>
<p>Composite graph indexes do not natively support ordering search
    results. All results will be retrieved and then sorted in-memory.
    For large result sets, this can be very expensive.</p>
</li>
<li>
<p>Mixed indexes support ordering natively and efficiently. However,
    the property key used in the order().by() method must have been
    previously added to the mixed indexed for native result ordering
    support. This is important in cases where the the order().by() key
    is different from the query keys. If the property key is not part of
    the index, then sorting requires loading all results into memory.</p>
</li>
</ul>
<h3 id="label-constraint">Label Constraint</h3>
<p>In many cases it is desirable to only index vertices or edges with a
particular label. For instance, one may want to index only gods by their
name and not every single vertex that has a name property. When defining
an index it is possible to restrict the index to a particular vertex or
edge label using the <code>indexOnly</code> method of the index builder. The
following creates a composite index for the property key <code>name</code> that
indexes only vertices labeled <code>god</code>.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
<span class="n">god</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getVertexLabel</span><span class="o">(</span><span class="s1">&#39;god&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildIndex</span><span class="o">(</span><span class="s1">&#39;byNameAndLabel&#39;</span><span class="o">,</span> <span class="n">Vertex</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">addKey</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">indexOnly</span><span class="o">(</span><span class="n">god</span><span class="o">).</span><span class="na">buildCompositeIndex</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitGraphIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;byNameAndLabel&#39;</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//You can check the indexOnly constraint built just now</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">getIndexOnlyConstraint</span><span class="o">(</span><span class="s2">&quot;byNameAndLabel&quot;</span><span class="o">)</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getGraphIndex</span><span class="o">(</span><span class="s2">&quot;byNameAndLabel&quot;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<p>Label restrictions similarly apply to mixed indexes. When a composite
index with label restriction is defined as unique, the uniqueness
constraint only applies to properties on vertices or edges for the
specified label.</p>
<h3 id="composite-versus-mixed-indexes">Composite versus Mixed Indexes</h3>
<ol>
<li>
<p>Use a composite index for exact match index retrievals. Composite
    indexes do not require configuring or operating an external index
    system and are often significantly faster than mixed indexes.</p>
<ol>
<li>As an exception, use a mixed index for exact matches when the
    number of distinct values for query constraint is relatively
    small or if one value is expected to be associated with many
    elements in the graph (i.e. in case of low selectivity).</li>
</ol>
</li>
<li>
<p>Use a mixed indexes for numeric range, full-text or geo-spatial
    indexing. Also, using a mixed index can speed up the order().by()
    queries.</p>
</li>
<li>
<p>A composite index requires all fields to be present, while a mixed
    index only needs at least one field to be present. For example, say
    you have a composite index with <code>key1</code> and <code>key2</code>, a mixed index with
    <code>key1</code> and <code>key3</code>. If you add a vertex with only property <code>key1</code>, then
    JanusGraph will create a new mixed index entry but not a composite index
    entry.</p>
</li>
</ol>
<h2 id="vertex-centric-indexes">Vertex-centric Indexes</h2>
<p>Vertex-centric indexes, also known as Relation indexes, are local index
structures built individually per vertex. They are stored together with edges
and properties in <code>edgeStore</code>. There are two types of vertex-centric indexes,
edge indexes and property indexes.</p>
<h3 id="edge-indexes">Edge Indexes</h3>
<p>In large graphs vertices can have thousands of incident edges.
Traversing through those vertices can be very slow because a large
subset of the incident edges has to be retrieved and then filtered in
memory to match the conditions of the traversal. Vertex-centric indexes
can speed up such traversals by using localized index structures to
retrieve only those edges that need to be traversed.</p>
<p>Suppose that Hercules battled hundreds of monsters in addition to the
three captured in the introductory <a href="../../../getting-started/basic-usage/">Graph of the Gods</a>. Without a vertex-centric index, a query asking
for those monsters battled between time point <code>10</code> and <code>20</code> would
require retrieving all <code>battled</code> edges even though there are only a
handful of matching edges.
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">,</span> <span class="n">inside</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">)).</span><span class="na">inV</span><span class="o">()</span>
</code></pre></div></p>
<p>Building a vertex-centric index by time speeds up such traversal
queries. Note, this initial index example already exists in the <em>Graph
of the Gods</em> as an index named <code>edges</code>. As a result, running the steps
below will result in a uniqueness constraint error.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">)</span>
<span class="n">battled</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getEdgeLabel</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildEdgeIndex</span><span class="o">(</span><span class="n">battled</span><span class="o">,</span> <span class="s1">&#39;battlesByTime&#39;</span><span class="o">,</span> <span class="n">Direction</span><span class="o">.</span><span class="na">BOTH</span><span class="o">,</span> <span class="n">Order</span><span class="o">.</span><span class="na">desc</span><span class="o">,</span> <span class="n">time</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitRelationIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;battlesByTime&#39;</span><span class="o">,</span> <span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getRelationIndex</span><span class="o">(</span><span class="n">battled</span><span class="o">,</span> <span class="s2">&quot;battlesByTime&quot;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<p>This example builds a vertex-centric index which indexes <code>battled</code> edges
in both direction by time in descending order. A vertex-centric index is
built against a particular edge label which is the first argument to the
index construction method <code>JanusGraphManagement.buildEdgeIndex()</code>. The
index only applies to edges of this label - <code>battled</code> in the example
above. The second argument is a unique name for the index. The third
argument is the edge direction in which the index is built. The index
will only apply to traversals along edges in this direction. In this
example, the vertex-centric index is built in both direction which means
that time restricted traversals along <code>battled</code> edges can be served by
this index in both the <code>IN</code> and <code>OUT</code> direction. JanusGraph will
maintain a vertex-centric index on both the in- and out-vertex of
<code>battled</code> edges. Alternatively, one could define the index to apply to
the <code>OUT</code> direction only which would speed up traversals from Hercules
to the monsters but not in the reverse direction. This would only
require maintaining one index and hence half the index maintenance and
storage cost. The last two arguments are the sort order of the index and
a list of property keys to index by. The sort order is optional and
defaults to ascending order (i.e. <code>Order.ASC</code>). The list of property
keys must be non-empty and defines the keys by which to index the edges
of the given label. A vertex-centric index can be defined with multiple
keys.
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">rollback</span><span class="o">()</span>  <span class="c1">//Never create new indexes while a transaction is active</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getPropertyKey</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">)</span>
<span class="n">rating</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">makePropertyKey</span><span class="o">(</span><span class="s1">&#39;rating&#39;</span><span class="o">).</span><span class="na">dataType</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">make</span><span class="o">()</span>
<span class="n">battled</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">getEdgeLabel</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildEdgeIndex</span><span class="o">(</span><span class="n">battled</span><span class="o">,</span> <span class="s1">&#39;battlesByRatingAndTime&#39;</span><span class="o">,</span> <span class="n">Direction</span><span class="o">.</span><span class="na">OUT</span><span class="o">,</span> <span class="n">Order</span><span class="o">.</span><span class="na">desc</span><span class="o">,</span> <span class="n">rating</span><span class="o">,</span> <span class="n">time</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
<span class="c1">//Wait for the index to become available</span>
<span class="n">ManagementSystem</span><span class="o">.</span><span class="na">awaitRelationIndexStatus</span><span class="o">(</span><span class="n">graph</span><span class="o">,</span> <span class="s1">&#39;battlesByRatingAndTime&#39;</span><span class="o">,</span> <span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">call</span><span class="o">()</span>
<span class="c1">//Reindex the existing data</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">updateIndex</span><span class="o">(</span><span class="n">mgmt</span><span class="o">.</span><span class="na">getRelationIndex</span><span class="o">(</span><span class="n">battled</span><span class="o">,</span> <span class="s1">&#39;battlesByRatingAndTime&#39;</span><span class="o">),</span> <span class="n">SchemaAction</span><span class="o">.</span><span class="na">REINDEX</span><span class="o">).</span><span class="na">get</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>
</code></pre></div></p>
<p>This example extends the schema by a <code>rating</code> property on <code>battled</code>
edges and builds a vertex-centric index which indexes <code>battled</code> edges in
the out-going direction by rating and time in descending order. Note,
that the order in which the property keys are specified is important
because vertex-centric indexes are prefix indexes. This means, that
<code>battled</code> edges are indexed by <code>rating</code> <em>first</em> and <code>time</code> <em>second</em>.
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">property</span><span class="o">(</span><span class="s1">&#39;rating&#39;</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">)</span> <span class="c1">//Add some rating properties</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;rating&#39;</span><span class="o">,</span> <span class="n">gt</span><span class="o">(</span><span class="mf">3.0</span><span class="o">)).</span><span class="na">inV</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;rating&#39;</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">,</span> <span class="n">inside</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">50</span><span class="o">)).</span><span class="na">inV</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">,</span> <span class="n">inside</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">50</span><span class="o">)).</span><span class="na">inV</span><span class="o">()</span>
</code></pre></div></p>
<p>Hence, the <code>battlesByRatingAndTime</code> index can speed up the first two but
not the third query.</p>
<h3 id="property-indexes">Property Indexes</h3>
<p>Similar to edge indexes, property indexes can be built to traverse properties
based on associated meta-properties efficiently. The following toy example
illustrates the usage of property indexes.</p>
<div class="highlight"><pre><span></span><code><span class="n">graph</span> <span class="o">=</span> <span class="n">JanusGraphFactory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="s2">&quot;inmemory&quot;</span><span class="o">)</span>
<span class="n">mgmt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">openManagement</span><span class="o">()</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">makePropertyKey</span><span class="o">(</span><span class="s2">&quot;timestamp&quot;</span><span class="o">).</span><span class="na">dataType</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">make</span><span class="o">()</span>
<span class="n">amount</span> <span class="o">=</span> <span class="n">mgmt</span><span class="o">.</span><span class="na">makePropertyKey</span><span class="o">(</span><span class="s2">&quot;amount&quot;</span><span class="o">).</span><span class="na">dataType</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">cardinality</span><span class="o">(</span><span class="n">Cardinality</span><span class="o">.</span><span class="na">LIST</span><span class="o">).</span><span class="na">make</span><span class="o">()</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">buildPropertyIndex</span><span class="o">(</span><span class="n">amount</span><span class="o">,</span> <span class="s1">&#39;amountByTime&#39;</span><span class="o">,</span> <span class="n">Order</span><span class="o">.</span><span class="na">desc</span><span class="o">,</span> <span class="n">timestamp</span><span class="o">)</span>
<span class="n">mgmt</span><span class="o">.</span><span class="na">commit</span><span class="o">()</span>

<span class="n">bob</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">addVertex</span><span class="o">()</span>
<span class="n">bob</span><span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s2">&quot;amount&quot;</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="o">,</span> <span class="mi">1600000000</span><span class="o">)</span>
<span class="n">bob</span><span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s2">&quot;amount&quot;</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="o">,</span> <span class="mi">1500000000</span><span class="o">)</span>
<span class="n">bob</span><span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s2">&quot;amount&quot;</span><span class="o">,</span> <span class="o">-</span><span class="mi">150</span><span class="o">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="o">,</span> <span class="mi">1550000000</span><span class="o">)</span>
<span class="n">graph</span><span class="o">.</span><span class="na">tx</span><span class="o">().</span><span class="na">commit</span><span class="o">()</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">traversal</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">bob</span><span class="o">).</span><span class="na">properties</span><span class="o">(</span><span class="s2">&quot;amount&quot;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s2">&quot;timestamp&quot;</span><span class="o">,</span> <span class="n">P</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">1500000000</span><span class="o">))</span>
</code></pre></div>

<p>In the above example, we model a number of transactions Bob has made. <code>amount</code> is a vertex
property that records the amount of money involved in each transaction, while <code>timestamp</code> is
a meta property of <code>amount</code> which records the time that a particular record happens. By creating
a property index, we can efficiently retrieve transaction amounts by timestamp. Alternatively,
we can also model the transactions as edges, then both <code>amount</code> and <code>timestamp</code> will be edge
properties, and we could use Edge indexes to speed up the query.</p>
<p>Multiple vertex-centric indexes can be built for the same edge label in
order to support different constraint traversals. JanusGraph’s query
optimizer attempts to pick the most efficient index for any given
traversal. Vertex-centric indexes only support equality and
range/interval constraints.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The property keys used in a vertex-centric index must have an
explicitly defined data type (i.e. <em>not</em> <code>Object.class</code>) which
supports a native sort order. This means not only that they must implement <code>Comparable</code> 
but that their serializer must implement <code>OrderPreservingSerializer</code>. 
The types that are currently supported are <code>Boolean</code>, <code>UUID</code>, <code>Byte</code>, <code>Float</code>, <code>Long</code>, <code>String</code>, 
<code>Integer</code>, <code>Date</code>, <code>Double</code>, <code>Character</code>, and <code>Short</code></p>
</div>
<p>If the vertex-centric index is built against either an edge label or at least one
property key that is defined in the same management transaction, the index will be
immediately available for querying. If both the edge label and all of the indexed
property keys have already been in use, building a vertex-centric index against it requires the
execution of a <a href="../index-reindexing/">reindex procedure</a> to ensure that the index
contains all previously added edges. Until the reindex procedure has
completed, the index will not be available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>JanusGraph automatically builds vertex-centric indexes per edge label
and property key. That means, even with thousands of incident
<code>battled</code> edges, queries like <code>g.V(h).out('mother')</code> or
<code>g.V(h).values('age')</code> are efficiently answered by the local index.</p>
</div>
<p>Vertex-centric indexes cannot speed up unconstrained traversals which
require traversing through all incident edges of a particular label.
Those traversals will become slower as the number of incident edges
increases. Often, such traversals can be rewritten as constrained
traversals that can utilize a vertex-centric index to ensure acceptable
performance at scale.</p>
<h3 id="using-vertex-centric-indexes-on-adjacent-vertex-ids">Using vertex-centric indexes on adjacent vertex ids</h3>
<p>In some cases it is relevant to find an edge based on properties of the adjacent vertex.
Let's say we want to find out whether or not Hercules has battled Cerberus.
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">out</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;cerberus&#39;</span><span class="o">).</span><span class="na">hasNext</span><span class="o">()</span>
</code></pre></div></p>
<p>A query like this can not use a vertex centric index because it filters
on vertex properties rather than edge properties.
But by restructuring the query, we can achieve exactly this.
As both vertices are known, the vertex ids can be used to select the edge.
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;cerberus&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
</code></pre></div></p>
<p>In contrast to the name "Cebereus", which is a property of the adjacent vertex,
the id of this vertex is already saved within the connecting edge itself.
Therefore, this query runs much faster if hercules has battled many opponents:
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">inV</span><span class="o">().</span><span class="na">is</span><span class="o">(</span><span class="n">c</span><span class="o">)).</span><span class="na">hasNext</span><span class="o">()</span>
</code></pre></div></p>
<p>... or even shorter:
<div class="highlight"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">out</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">is</span><span class="o">(</span><span class="n">c</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">hasNext</span><span class="o">()</span>
</code></pre></div></p>
<p>Assuming there is a global index on the <code>name</code> property, this improves the performance
a lot, because it's not necessary to fetch every adjacent vertex anymore.
In addition, a vertex-centric index on adjacent vertex ids does not need to
be constructed and maintained explicitly.
Due to the <a href="../../../advanced-topics/data-model/">data model</a>, efficient access to
edges by their adjacent vertex id is already provided by the storage backend.</p>
<h3 id="ordered-traversals">Ordered Traversals</h3>
<p>The following queries specify an order in which the incident edges are
to be traversed. Use the <code>localLimit</code> command to retrieve a subset of
the edges (in a given order) for EACH vertex that is traversed.
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">().</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="s1">&#39;hercules&#39;</span><span class="o">).</span><span class="na">next</span><span class="o">()</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">local</span><span class="o">(</span><span class="n">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">order</span><span class="o">().</span><span class="na">by</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">,</span> <span class="n">desc</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">inV</span><span class="o">().</span><span class="na">values</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
<span class="n">g</span><span class="o">.</span><span class="na">V</span><span class="o">(</span><span class="n">h</span><span class="o">).</span><span class="na">local</span><span class="o">(</span><span class="n">outE</span><span class="o">(</span><span class="s1">&#39;battled&#39;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s1">&#39;rating&#39;</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">).</span><span class="na">order</span><span class="o">().</span><span class="na">by</span><span class="o">(</span><span class="s1">&#39;time&#39;</span><span class="o">,</span> <span class="n">desc</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">values</span><span class="o">(</span><span class="s1">&#39;place&#39;</span><span class="o">)</span>
</code></pre></div></p>
<p>The first query asks for the names of the 10 most recently battled
monsters by Hercules. The second query asks for the places of the 10
most recent battles of Hercules that are rated 5 stars. In both cases,
the query is constrained by an order on a property key with a limit on
the number of elements to be returned.</p>
<p>Such queries can also be efficiently answered by vertex-centric indexes
if the order key matches the key of the index and the requested order
(i.e. ascending or descending) is the same as the one defined for the
index. The <code>battlesByTime</code> index would be used to answer the first query
and <code>battlesByRatingAndTime</code> applies to the second. Note, that the
<code>battlesByRatingAndTime</code> index cannot be used to answer the first query
because an equality constraint on <code>rating</code> must be present for the
second key in the index to be effective.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../advschema/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Advanced Schema
              </div>
            </div>
          </a>
        
        
          <a href="../index-lifecycle/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Index Lifecycle
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2023 JanusGraph Authors. All rights reserved.<br> The Linux Foundation has registered trademarks and uses trademarks. For a list of<br> trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page.<br> Cassandra, Groovy, HBase, Hadoop, Lucene, Solr, and TinkerPop are trademarks of the Apache Software Foundation.<br> Berkeley DB and Berkeley DB Java Edition are trademarks of Oracle.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../theme/js/structor-menu.js"></script>
      
    
  </body>
</html>